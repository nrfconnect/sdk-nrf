#
# Copyright (c) 2023 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause

get_property(PM_DOMAINS GLOBAL PROPERTY PM_DOMAINS)

# Include network core image if enabled
if(SB_CONFIG_SUPPORT_NETCORE AND NOT SB_CONFIG_NETCORE_NONE AND DEFINED SB_CONFIG_NETCORE_IMAGE_NAME)
  ExternalZephyrProject_Add(
    APPLICATION ${SB_CONFIG_NETCORE_IMAGE_NAME}
    SOURCE_DIR ${SB_CONFIG_NETCORE_IMAGE_PATH}
    BOARD ${SB_CONFIG_NETCORE_REMOTE_BOARD_NAME}
  )

  if(NOT "${SB_CONFIG_NETCORE_IMAGE_DOMAIN}" IN_LIST PM_DOMAINS)
    list(APPEND PM_DOMAINS ${SB_CONFIG_NETCORE_IMAGE_DOMAIN})
  endif()

  set_property(GLOBAL APPEND PROPERTY
               PM_${SB_CONFIG_NETCORE_IMAGE_DOMAIN}_IMAGES
               "${SB_CONFIG_NETCORE_IMAGE_NAME}"
  )

  set_property(GLOBAL PROPERTY DOMAIN_APP_${SB_CONFIG_NETCORE_IMAGE_DOMAIN}
               "${SB_CONFIG_NETCORE_IMAGE_NAME}"
  )

  set(${SB_CONFIG_NETCORE_IMAGE_DOMAIN}_PM_DOMAIN_DYNAMIC_PARTITION
      ${SB_CONFIG_NETCORE_IMAGE_NAME} CACHE INTERNAL ""
  )
endif()

set_property(GLOBAL PROPERTY PM_DOMAINS ${PM_DOMAINS})
