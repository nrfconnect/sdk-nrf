#
# Copyright (c) 2025 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

CONFIG_ZTEST=y

CONFIG_BOOTLOADER_MCUBOOT=y

# Bring in PSA crypto library
CONFIG_NRF_SECURITY=y
CONFIG_MBEDTLS_PSA_CRYPTO_C=y
CONFIG_PSA_CRYPTO_DRIVER_CRACEN=y

# Key storage library
CONFIG_CRACEN_LIB_KMU=y

# PSA depends on mbedTLS heap; insufficient heap can cause strange
# failures, for example signature verification failing with
# invalid signature error.
CONFIG_MBEDTLS_ENABLE_HEAP=y
CONFIG_MBEDTLS_HEAP_SIZE=2048

# These get us CONFIG_PSA_NEED_CRACEN_KEY_MANAGEMENT_DRIVER=y
CONFIG_PSA_WANT_ECC_TWISTED_EDWARDS_255=y

# These allow us to test import over locked key slots
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_IMPORT=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY=y

# Note: Key handle identifies key type; support for that type
# has to be enabled in Kconfig to be compiled in. If you get
# PSA_ERROR_HARDWARE_FAILURE, while attempting to use KMU key
# handle, with some PSA call, there is a chance that support
# for the key type has not been compiled in, and KMU does not
# have a code path to pick the key from storage.
#
# Enable ED25519 KMU key storage:
CONFIG_PSA_WANT_ALG_PURE_EDDSA=y
