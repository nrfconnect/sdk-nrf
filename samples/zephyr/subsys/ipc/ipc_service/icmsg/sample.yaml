sample:
  name: IPC Service example integration (icmsg backend)
common:
  timeout: 30
  tags:
    - ipc
    - ci_samples_zephyr_subsys_ipc_ipc_service_icmsg
  sysbuild: true
  platform_allow:
    - nrf54lm20dk/nrf54lm20a/cpuapp
    - nrf54lv10dk/nrf54lv10a/cpuapp
    - nrf54lv10dk@0.2.0/nrf54lv10a/cpuapp
  integration_platforms:
    - nrf54lv10dk/nrf54lv10a/cpuapp

tests:
  nrf.extended.sample.ipc.icmsg.nrf54l:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "host: IPC-service HOST demo started"
        - "host: Ep bounded"
        - "host: Perform sends for"
        - "host: Sent"
        - "host: Received"
        - "host: IPC-service HOST demo ended"

  nrf.extended.sample.ipc.icmsg.nrf54l_no_multithreading:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
      - icmsg_CONFIG_MULTITHREADING=n
      - icmsg_CONFIG_LOG_MODE_MINIMAL=y
      - remote_CONFIG_MULTITHREADING=n
      - remote_CONFIG_LOG_MODE_MINIMAL=y
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "I: IPC-service HOST demo started"
        - "I: Ep bounded"
        - "I: Perform sends for"
        - "I: Sent"
        - "I: Received"
        - "I: IPC-service HOST demo ended"

  nrf.extended.sample.ipc.icmsg.nrf54l_remote_no_multithreading:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
      - remote_CONFIG_MULTITHREADING=n
      - remote_CONFIG_LOG_MODE_MINIMAL=y
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "host: IPC-service HOST demo started"
        - "host: Ep bounded"
        - "host: Perform sends for"
        - "host: Sent"
        - "host: Received"
        - "host: IPC-service HOST demo ended"

  nrf.extended.sample.ipc.icbmsg.nrf54l:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
      - icmsg_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - icmsg_FILE_SUFFIX=icbmsg
      - remote_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - remote_FILE_SUFFIX=icbmsg
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "host: IPC-service HOST demo started"
        - "host: Ep bounded"
        - "host: Perform sends for"
        - "host: Sent"
        - "host: Received"
        - "host: IPC-service HOST demo ended"

  nrf.extended.sample.ipc.icbmsg.nrf54l_no_multithreading:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
      - icmsg_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - icmsg_FILE_SUFFIX=icbmsg
      - icmsg_CONFIG_MULTITHREADING=n
      - icmsg_CONFIG_LOG_MODE_MINIMAL=y
      - remote_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - remote_FILE_SUFFIX=icbmsg
      - remote_CONFIG_MULTITHREADING=n
      - remote_CONFIG_LOG_MODE_MINIMAL=y
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "I: IPC-service HOST demo started"
        - "I: Ep bounded"
        - "I: Perform sends for"
        - "I: Sent"
        - "I: Received"
        - "I: IPC-service HOST demo ended"

  nrf.extended.sample.ipc.icbmsg.nrf54l_remote_no_multithreading:
    extra_args:
      - icmsg_SNIPPET=nordic-flpr
      - icmsg_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - icmsg_FILE_SUFFIX=icbmsg
      - remote_CONFIG_IPC_SERVICE_BACKEND_ICBMSG_NUM_EP=1
      - remote_FILE_SUFFIX=icbmsg
      - remote_CONFIG_MULTITHREADING=n
      - remote_CONFIG_LOG_MODE_MINIMAL=y
    harness: console
    harness_config:
      type: multi_line
      ordered: false
      regex:
        - "host: IPC-service HOST demo started"
        - "host: Ep bounded"
        - "host: Perform sends for"
        - "host: Sent"
        - "host: Received"
        - "host: IPC-service HOST demo ended"
