sample:
  name: Mass Storage
common:
  min_ram: 128
  platform_allow:
    - nrf54h20dk/nrf54h20/cpuapp
    - nrf54lm20dk/nrf54lm20a/cpuapp
  integration_platforms:
    - nrf54h20dk/nrf54h20/cpuapp
    - nrf54lm20dk/nrf54lm20a/cpuapp
  extra_args:
    - EXTRA_DTC_OVERLAY_FILE="ramdisk.overlay"
  tags:
    - msd
    - usb
    - ci_samples_zephyr_subsys_usb

tests:
  nrf.extended.sample.usbd.mass_ram_none:
    harness: console
    harness_config:
      type: multi_line
      ordered: true
      regex:
        - "No file system selected"
        - "The device is put in USB mass storage mode."
        - "usbd_msc: Enable"
        - "usbd_msc: Bulk-Only Mass Storage Reset"
    extra_configs:
      - CONFIG_LOG_DEFAULT_LEVEL=3
  nrf.extended.sample.usbd.mass_ram_fat:
    harness: console
    harness_config:
      type: multi_line
      ordered: true
      regex:
        - "End of files"
        - "The device is put in USB mass storage mode."
        - "usbd_msc: Enable"
        - "usbd_msc: Bulk-Only Mass Storage Reset"
    extra_configs:
      - CONFIG_LOG_DEFAULT_LEVEL=3
      - CONFIG_APP_MSC_STORAGE_RAM=y
