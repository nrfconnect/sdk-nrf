# iperf3 common configuration
# This overlay provides shared settings for iperf3 testing

# Disable unused features for iperf3
CONFIG_DNS_RESOLVER=n
CONFIG_DNS_SD=n
CONFIG_DNS_RESOLVER_AUTO_INIT=n
CONFIG_DNS_RESOLVER_CACHE=n
CONFIG_DNS_SERVER_IP_ADDRESSES=n
CONFIG_MDNS_RESOLVER=n
CONFIG_MDNS_RESPONDER=n
CONFIG_MDNS_RESPONDER_DNS_SD=n
CONFIG_NET_SOCKETS_PACKET=n
CONFIG_NET_SOCKETS_PACKET_DGRAM=n
CONFIG_NET_SOCKETS_INET_RAW=n

# Desh feature configuration
CONFIG_SAMPLE_DESH_NATIVE_TLS=n

# iperf3 configuration
CONFIG_SAMPLE_DESH_IPERF3=y
CONFIG_NRF_IPERF3_HOST_NAME="nrf9151-dect-nr+-common config"
CONFIG_NRF_IPERF3_RESULTS_WAIT_TIME=180
CONFIG_NRF_IPERF3_NONBLOCKING_CLIENT_CHANGES=n

# DECT cluster (reduced for iperf3 testing)
CONFIG_DECT_CLUSTER_MAX_CHILD_ASSOCIATION_COUNT=5
CONFIG_NET_IPV6_MAX_NEIGHBORS=5
CONFIG_DECT_MDM_NRF_TX_FLOW_CTRL_BASED_ON_MDM_TX_DLC_REQS=y

# IP configuration
CONFIG_NET_IPV4=y
CONFIG_NET_IPV6=y
CONFIG_NET_IP_ADDR_CHECK=n

# TCP configuration
CONFIG_NET_TCP=y
CONFIG_NET_TCP_WORKQ_STACK_SIZE=2048
CONFIG_NET_TCP_INIT_RETRANSMISSION_TIMEOUT=6000
CONFIG_NET_TCP_RETRY_COUNT=6
# Disable RFC6528 to avoid MBEDTLS_MAC_MD5_ENABLED dependency
CONFIG_NET_TCP_ISN_RFC6528=n

# Network sockets and contexts
CONFIG_POSIX_API=y
CONFIG_ZVFS_POLL_MAX=15
CONFIG_NET_MAX_CONTEXTS=15
CONFIG_NET_MAX_CONN=15

# Network buffers
CONFIG_NET_BUF=y
CONFIG_NET_BUF_DATA_SIZE=128
CONFIG_NET_BUF_POOL_USAGE=y
CONFIG_NET_TC_RX_COUNT=0

# Json library
CONFIG_CJSON_LIB=y

# Memory optimizations
CONFIG_HEAP_MEM_POOL_SIZE=1024
CONFIG_SHELL_CMD_BUFF_SIZE=512
