#
# Copyright (c) 2020 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

# Enable PPP MoSH support:
CONFIG_MOSH_PPP=y
CONFIG_MOSH_IPERF3=y
CONFIG_MOSH_WORKER_THREADS=n
CONFIG_MOSH_SOCK=n
CONFIG_MOSH_PING=y
CONFIG_MOSH_CURL=n
CONFIG_MOSH_LINK=y
CONFIG_MOSH_GNSS=n
CONFIG_MOSH_SMS=n
CONFIG_MOSH_LOCATION=n
CONFIG_MOSH_REST=n
CONFIG_DATE_TIME=n
CONFIG_SMS=n

# Enable net shell commands
CONFIG_NET_SHELL=y
CONFIG_NET_STATISTICS_PPP=y
CONFIG_NET_STATISTICS_USER_API=y

# Enable needed stuff from native net stack
CONFIG_NET_NATIVE=y
CONFIG_NET_STATISTICS=y
CONFIG_NET_STATISTICS_PPP=y
CONFIG_NET_STATISTICS_IPV4=n
CONFIG_NET_STATISTICS_ICMP=n
CONFIG_NET_STATISTICS_UDP=n

CONFIG_NET_MGMT_EVENT_STACK_SIZE=1024

CONFIG_NET_LOG=y
CONFIG_NET_CONFIG_AUTO_INIT=y

CONFIG_NET_SOCKETS=y
CONFIG_NET_SOCKETS_PACKET=y
CONFIG_NET_SOCKETS_PACKET_DGRAM=n

CONFIG_NET_IF_MAX_IPV4_COUNT=2
CONFIG_NET_IF_MAX_IPV6_COUNT=2

CONFIG_NET_IPV4=y
CONFIG_NET_IPV6=y

CONFIG_NET_IP_ADDR_CHECK=n

CONFIG_NET_DRIVERS=y

# Default PPP net_if
CONFIG_NET_DEFAULT_IF_PPP=y
CONFIG_PPP_NET_IF_NO_AUTO_START=y

# Asynch UART API used for PPP
CONFIG_SERIAL=y

CONFIG_UART_ASYNC_API=y
CONFIG_UART_LINE_CTRL=y

CONFIG_UART_0_INTERRUPT_DRIVEN=n
CONFIG_UART_0_ASYNC=y
CONFIG_UART_0_NRF_HW_ASYNC=y
CONFIG_UART_0_NRF_HW_ASYNC_TIMER=1
#CONFIG_UART_0_NRF_ASYNC_LOW_POWER=y

CONFIG_NET_PPP_UART_BUF_LEN=2048
CONFIG_NET_PPP_ASYNC_UART_TX_BUF_LEN=4096

#CONFIG_NET_PPP_RX_PRIORITY=15
CONFIG_NET_PPP_DRV_NAME="ppp"
CONFIG_NET_PPP_RINGBUF_SIZE=4096
CONFIG_NET_PPP_RX_STACK_SIZE=2048
CONFIG_NET_PPP_VERIFY_FCS=n
#CONFIG_NET_PPP_ASYNC_UART_RX_ENABLE_TIMEOUT=10
#CONFIG_NET_PPP_ASYNC_UART_TX_TIMEOUT=10

#CONFIG_NRF_MODEM_LIB_SHMEM_TX_SIZE=32768
#CONFIG_NRF_MODEM_LIB_SHMEM_RX_SIZE=32768

# UART PPP driver
CONFIG_NET_PPP=y
CONFIG_NET_PPP_ASYNC_UART=y

# L2 protocol configs
CONFIG_NET_L2_PPP=y
CONFIG_NET_L2_PPP_MGMT=y

CONFIG_NET_L2_PPP_OPTION_MRU=y
CONFIG_NET_L2_PPP_OPTION_SERVE_IP=y
CONFIG_NET_L2_PPP_OPTION_SERVE_DNS=y
CONFIG_NET_L2_PPP_MAX_TERMINATE_REQ_RETRANSMITS=1
CONFIG_NET_L2_PPP_TIMEOUT=5000
CONFIG_NET_L2_PPP_MAX_CONFIGURE_REQ_RETRANSMITS=20

# Windows support
CONFIG_PPP_CLIENT_CLIENTSERVER=y

# Default PPP MRU option config
CONFIG_NET_PPP_MTU_MRU=1280

# Network buffers
CONFIG_NET_BUF=y
CONFIG_NET_BUF_DATA_SIZE=128
CONFIG_NET_BUF_POOL_USAGE=y

CONFIG_NET_PKT_RX_COUNT=44
CONFIG_NET_BUF_RX_COUNT=88

CONFIG_NET_PKT_TX_COUNT=44
CONFIG_NET_BUF_TX_COUNT=88

CONFIG_NET_TC_RX_COUNT=0

# UART traces cannot be enabled
CONFIG_NRF_MODEM_LIB_TRACE=n

# Debug options
CONFIG_NET_PPP_LOG_LEVEL_WRN=y
CONFIG_NET_L2_PPP_LOG_LEVEL_WRN=y
CONFIG_NET_CORE_LOG_LEVEL_WRN=y
CONFIG_NET_IF_LOG_LEVEL_WRN=y

CONFIG_NET_PKT_LOG_LEVEL_WRN=y
CONFIG_NET_DEBUG_NET_PKT_ALLOC=y

CONFIG_NET_CONTEXT_LOG_LEVEL_WRN=y
CONFIG_UART_CONSOLE_LOG_LEVEL_WRN=y

CONFIG_NET_BUF_LOG_LEVEL_OFF=y

CONFIG_NET_CONN_LOG_LEVEL_WRN=y
CONFIG_NET_BUF_WARN_ALLOC_INTERVAL=0

CONFIG_ASSERT=y
CONFIG_RESET_ON_FATAL_ERROR=n
CONFIG_LOG_PROCESS_THREAD_STACK_SIZE=4096
