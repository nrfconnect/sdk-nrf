#
# Copyright (c) 2021 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

# Enable networking
CONFIG_NETWORKING=y

# Enable OpenThread
CONFIG_NET_L2_OPENTHREAD=y

# Set OpenThread Radio Co-Processor architecture
CONFIG_OPENTHREAD_COPROCESSOR=y
CONFIG_OPENTHREAD_COPROCESSOR_RCP=y

# Use basic 802154 service layer
CONFIG_NRF_802154_SL_OPENSOURCE=y

# Use built-in mbedtls
CONFIG_OPENTHREAD_NRF_SECURITY=n
CONFIG_OPENTHREAD_MBEDTLS=y
CONFIG_MBEDTLS_HEAP_SIZE=0

# Disable unnecessary features
CONFIG_BOOT_BANNER=n
CONFIG_ASSERT=n
CONFIG_LOG=n
CONFIG_CONSOLE=n
CONFIG_PRINTK=n
CONFIG_CBPRINTF_NANO=y
CONFIG_GPIO=n
CONFIG_NET_LOG=n
CONFIG_FPU=n
CONFIG_NET_CONNECTION_MANAGER=n
CONFIG_NEWLIB_LIBC=n
CONFIG_MINIMAL_LIBC=y
CONFIG_NET_STATISTICS=n

# Disable certain parts of Zephyr IPv6 stack
CONFIG_NET_IPV6_NBR_CACHE=n
CONFIG_NET_IPV6_MLD=n

# Optimize stacks
CONFIG_OPENTHREAD_THREAD_STACK_SIZE=1024
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=512
CONFIG_MAIN_STACK_SIZE=1024
CONFIG_ISR_STACK_SIZE=512
CONFIG_IDLE_STACK_SIZE=256
CONFIG_STACK_SENTINEL=y
CONFIG_NET_TX_STACK_SIZE=256
CONFIG_NET_RX_STACK_SIZE=512

# Optimize buffers
CONFIG_OPENTHREAD_COPROCESSOR_UART_RING_BUFFER_SIZE=1024
CONFIG_OPENTHREAD_PKT_LIST_SIZE=1

CONFIG_NET_PKT_RX_COUNT=1
CONFIG_NET_BUF_RX_COUNT=1
CONFIG_NET_PKT_TX_COUNT=2
CONFIG_NET_BUF_TX_COUNT=2

CONFIG_NET_MAX_CONN=0
CONFIG_NET_MAX_CONTEXTS=0

CONFIG_NET_IF_MAX_IPV6_COUNT=1
CONFIG_NET_IF_UNICAST_IPV6_ADDR_COUNT=1
CONFIG_NET_IF_MCAST_IPV6_ADDR_COUNT=1
CONFIG_NET_IF_IPV6_PREFIX_COUNT=1

CONFIG_NRF_802154_PENDING_SHORT_ADDRESSES=8
CONFIG_NRF_802154_PENDING_EXTENDED_ADDRESSES=8
CONFIG_NRF_802154_RX_BUFFERS=8
